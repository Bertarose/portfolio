<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Latent Organ — Interface</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { margin: 0; overflow: hidden; font-family: 'Courier New', monospace; }
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: #374151;
      border-radius: 5px;
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      background: #06b6d4;
      cursor: pointer;
      border-radius: 50%;
    }
    input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      background: #06b6d4;
      cursor: pointer;
      border-radius: 50%;
      border: none;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    // Lucide icons as SVG components
    const Play = () => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polygon points="5 3 19 12 5 21 5 3"></polygon>
      </svg>
    );
    const Pause = () => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <rect x="6" y="4" width="4" height="16"></rect>
        <rect x="14" y="4" width="4" height="16"></rect>
      </svg>
    );
    const RotateCcw = () => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polyline points="1 4 1 10 7 10"></polyline>
        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
      </svg>
    );
    const Layers = () => (
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
        <polyline points="2 17 12 22 22 17"></polyline>
        <polyline points="2 12 12 17 22 12"></polyline>
      </svg>
    );

    const LatentOrganInterface = () => {
      const [isPlaying, setIsPlaying] = useState(false);
      const [xyPos, setXyPos] = useState({ x: 0.5, y: 0.5 });
      const [latentDims, setLatentDims] = useState(Array(8).fill(0));
      const [pathHistory, setPathHistory] = useState([]);
      const [selectedPreset, setSelectedPreset] = useState(null);
      const canvasRef = useRef(null);
      const xyPadRef = useRef(null);
      const isDragging = useRef(false);
      const animationRef = useRef(null);

      // Presets
      const presets = [
        { name: 'Organ Pure', color: '#00ff88', coords: [0, 0, 0, 0, 0, 0, 0, 0] },
        { name: 'Shimmer', color: '#00ddff', coords: [0.7, -0.3, 0.5, 0, 0.2, -0.4, 0, 0.1] },
        { name: 'Dark Pulse', color: '#ff0080', coords: [-0.8, 0.6, -0.3, 0.4, 0, 0.5, -0.2, 0] },
        { name: 'Granular', color: '#ffaa00', coords: [0.3, 0.4, -0.6, 0.8, -0.5, 0.1, 0.3, -0.2] },
      ];

      // Particles
      const particles = useRef(
        Array(80).fill(null).map(() => ({
          x: (Math.random() - 0.5) * 2,
          y: (Math.random() - 0.5) * 2,
          z: (Math.random() - 0.5) * 2,
          vx: (Math.random() - 0.5) * 0.002,
          vy: (Math.random() - 0.5) * 0.002,
          vz: (Math.random() - 0.5) * 0.002,
          size: Math.random() * 2 + 1,
        }))
      ).current;

      const handleXYPadInteraction = (e) => {
        if (!xyPadRef.current) return;
        const rect = xyPadRef.current.getBoundingClientRect();
        const x = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
        const y = Math.max(0, Math.min(1, (e.clientY - rect.top) / rect.height));
        
        setXyPos({ x, y });
        
        const newLatent = [...latentDims];
        newLatent[0] = (x - 0.5) * 2;
        newLatent[1] = (y - 0.5) * 2;
        setLatentDims(newLatent);
        
        if (isPlaying) {
          setPathHistory(prev => [...prev.slice(-100), { x, y }]);
        }
      };

      const handleMouseDown = (e) => {
        isDragging.current = true;
        handleXYPadInteraction(e);
      };

      const handleMouseMove = (e) => {
        if (isDragging.current) {
          handleXYPadInteraction(e);
        }
      };

      const handleMouseUp = () => {
        isDragging.current = false;
      };

      const handleDimSlider = (index, value) => {
        const newLatent = [...latentDims];
        newLatent[index] = value;
        setLatentDims(newLatent);
        
        if (index === 0) setXyPos(prev => ({ ...prev, x: (value + 1) / 2 }));
        if (index === 1) setXyPos(prev => ({ ...prev, y: (value + 1) / 2 }));
      };

      const loadPreset = (preset) => {
        setSelectedPreset(preset.name);
        setLatentDims(preset.coords);
        setXyPos({
          x: (preset.coords[0] + 1) / 2,
          y: (preset.coords[1] + 1) / 2,
        });
      };

      const handleReset = () => {
        setLatentDims(Array(8).fill(0));
        setXyPos({ x: 0.5, y: 0.5 });
        setPathHistory([]);
        setSelectedPreset(null);
      };

      useEffect(() => {
        const canvas = canvasRef.current;
        if (!canvas) return;
        
        const ctx = canvas.getContext('2d');
        const width = canvas.width = canvas.offsetWidth * window.devicePixelRatio;
        const height = canvas.height = canvas.offsetHeight * window.devicePixelRatio;
        ctx.scale(window.devicePixelRatio, window.devicePixelRatio);

        let rotation = 0;

        const animate = () => {
          ctx.fillStyle = 'rgba(10, 10, 15, 0.1)';
          ctx.fillRect(0, 0, width, height);

          rotation += 0.003;

          particles.forEach((p, i) => {
            p.x += p.vx + latentDims[0] * 0.001;
            p.y += p.vy + latentDims[1] * 0.001;
            p.z += p.vz + latentDims[2] * 0.001;

            if (Math.abs(p.x) > 1.5) p.x *= -0.9;
            if (Math.abs(p.y) > 1.5) p.y *= -0.9;
            if (Math.abs(p.z) > 1.5) p.z *= -0.9;

            const cosR = Math.cos(rotation);
            const sinR = Math.sin(rotation);
            const x = p.x * cosR - p.z * sinR;
            const z = p.x * sinR + p.z * cosR;

            const scale = 200 / (200 + z * 100);
            const x2d = x * scale * 150 + width / (2 * window.devicePixelRatio);
            const y2d = p.y * scale * 150 + height / (2 * window.devicePixelRatio);

            const hue = (i * 7 + rotation * 20 + latentDims[3] * 50) % 360;
            const brightness = 50 + Math.abs(latentDims[4]) * 30;
            
            ctx.fillStyle = `hsla(${hue}, 80%, ${brightness}%, ${0.6 * scale})`;
            ctx.beginPath();
            ctx.arc(x2d, y2d, p.size * scale, 0, Math.PI * 2);
            ctx.fill();

            particles.forEach((p2, j) => {
              if (j <= i) return;
              const dx = p.x - p2.x;
              const dy = p.y - p2.y;
              const dz = p.z - p2.z;
              const dist = Math.sqrt(dx * dx + dy * dy + dz * dz);
              
              if (dist < 0.4) {
                const x2 = p2.x * cosR - p2.z * sinR;
                const z2 = p2.x * sinR + p2.z * cosR;
                const scale2 = 200 / (200 + z2 * 100);
                const x2d2 = x2 * scale2 * 150 + width / (2 * window.devicePixelRatio);
                const y2d2 = p2.y * scale2 * 150 + height / (2 * window.devicePixelRatio);
                
                ctx.strokeStyle = `hsla(${hue}, 70%, 50%, ${0.2 * (1 - dist / 0.4)})`;
                ctx.lineWidth = 0.5;
                ctx.beginPath();
                ctx.moveTo(x2d, y2d);
                ctx.lineTo(x2d2, y2d2);
                ctx.stroke();
              }
            });
          });

          animationRef.current = requestAnimationFrame(animate);
        };

        animate();

        return () => {
          if (animationRef.current) {
            cancelAnimationFrame(animationRef.current);
          }
        };
      }, [latentDims, isPlaying]);

      useEffect(() => {
        window.addEventListener('mousemove', handleMouseMove);
        window.addEventListener('mouseup', handleMouseUp);
        return () => {
          window.removeEventListener('mousemove', handleMouseMove);
          window.removeEventListener('mouseup', handleMouseUp);
        };
      }, []);

      return (
        <div className="w-full h-screen bg-gray-950 text-gray-100 overflow-hidden flex flex-col font-mono">
          <div className="bg-gray-900 border-b border-cyan-500/30 p-4 flex items-center justify-between">
            <div className="flex items-center gap-3">
              <Layers />
              <h1 className="text-xl font-bold tracking-wider text-cyan-400">LATENT ORGAN</h1>
              <span className="text-xs text-gray-500 ml-2">v1.0 — Standalone</span>
            </div>
            <div className="flex gap-2">
              <button
                onClick={() => setIsPlaying(!isPlaying)}
                className="px-4 py-2 bg-cyan-500/20 hover:bg-cyan-500/30 border border-cyan-500/50 rounded flex items-center gap-2 transition-all"
              >
                {isPlaying ? <Pause /> : <Play />}
                {isPlaying ? 'PAUSE' : 'PLAY'}
              </button>
              <button
                onClick={handleReset}
                className="px-4 py-2 bg-pink-500/20 hover:bg-pink-500/30 border border-pink-500/50 rounded flex items-center gap-2 transition-all"
              >
                <RotateCcw />
                RESET
              </button>
            </div>
          </div>

          <div className="flex-1 flex overflow-hidden">
            <div className="w-80 bg-gray-900/50 border-r border-cyan-500/30 p-4 overflow-y-auto">
              <div className="space-y-6">
                <div>
                  <div className="text-xs text-cyan-400 mb-2 flex justify-between">
                    <span>LATENT NAVIGATION</span>
                    <span className="text-gray-500">Z0 × Z1</span>
                  </div>
                  <div
                    ref={xyPadRef}
                    onMouseDown={handleMouseDown}
                    className="relative w-full h-64 bg-black/50 border border-cyan-500/50 rounded cursor-crosshair overflow-hidden"
                  >
                    <div className="absolute inset-0 opacity-20">
                      {[...Array(8)].map((_, i) => (
                        <div key={`h${i}`} className="absolute w-full h-px bg-cyan-500" style={{ top: `${(i + 1) * 12.5}%` }} />
                      ))}
                      {[...Array(8)].map((_, i) => (
                        <div key={`v${i}`} className="absolute h-full w-px bg-cyan-500" style={{ left: `${(i + 1) * 12.5}%` }} />
                      ))}
                    </div>

                    <svg className="absolute inset-0 w-full h-full pointer-events-none">
                      <path
                        d={pathHistory.map((p, i) => 
                          `${i === 0 ? 'M' : 'L'} ${p.x * 100}% ${p.y * 100}%`
                        ).join(' ')}
                        fill="none"
                        stroke="rgba(0, 255, 136, 0.3)"
                        strokeWidth="2"
                      />
                    </svg>

                    <div
                      className="absolute w-4 h-4 bg-cyan-400 rounded-full transform -translate-x-1/2 -translate-y-1/2 shadow-lg shadow-cyan-400/50 pointer-events-none"
                      style={{
                        left: `${xyPos.x * 100}%`,
                        top: `${xyPos.y * 100}%`,
                      }}
                    >
                      <div className="absolute inset-0 bg-cyan-400 rounded-full animate-ping opacity-75" />
                    </div>
                  </div>
                  <div className="text-xs text-gray-500 mt-2 flex justify-between">
                    <span>X: {latentDims[0].toFixed(3)}</span>
                    <span>Y: {latentDims[1].toFixed(3)}</span>
                  </div>
                </div>

                <div>
                  <div className="text-xs text-cyan-400 mb-2">PRESETS</div>
                  <div className="grid grid-cols-2 gap-2">
                    {presets.map((preset) => (
                      <button
                        key={preset.name}
                        onClick={() => loadPreset(preset)}
                        className={`p-3 rounded border transition-all text-left ${
                          selectedPreset === preset.name
                            ? 'bg-cyan-500/30 border-cyan-500'
                            : 'bg-black/30 border-gray-700 hover:border-cyan-500/50'
                        }`}
                      >
                        <div
                          className="w-2 h-2 rounded-full mb-1"
                          style={{ backgroundColor: preset.color }}
                        />
                        <div className="text-xs font-semibold">{preset.name}</div>
                      </button>
                    ))}
                  </div>
                </div>

                <div>
                  <div className="text-xs text-cyan-400 mb-2">LATENT DIMENSIONS</div>
                  <div className="space-y-2">
                    {latentDims.map((val, i) => (
                      <div key={i}>
                        <div className="flex justify-between text-xs mb-1">
                          <span className="text-gray-500">Z{i}</span>
                          <span className="text-cyan-400">{val.toFixed(3)}</span>
                        </div>
                        <input
                          type="range"
                          min="-1"
                          max="1"
                          step="0.01"
                          value={val}
                          onChange={(e) => handleDimSlider(i, parseFloat(e.target.value))}
                          className="w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer"
                        />
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>

            <div className="flex-1 relative">
              <canvas ref={canvasRef} className="w-full h-full" />
              <div className="absolute top-4 left-4 text-xs text-cyan-400/50 space-y-1 pointer-events-none">
                <div>LATENT SPACE PROJECTION</div>
                <div className="text-gray-600">80 particles · 3D navigation</div>
              </div>
            </div>

            <div className="w-64 bg-gray-900/50 border-l border-cyan-500/30 p-4 overflow-y-auto">
              <div className="space-y-6">
                <div>
                  <div className="text-xs text-cyan-400 mb-3">SYSTEM STATUS</div>
                  <div className="space-y-2 text-xs">
                    <div className="flex justify-between">
                      <span className="text-gray-500">Model</span>
                      <span className="text-green-400">RAVE-v2</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-gray-500">Latency</span>
                      <span className="text-yellow-400">~25ms</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-gray-500">State</span>
                      <span className={isPlaying ? 'text-green-400' : 'text-gray-500'}>
                        {isPlaying ? 'ACTIVE' : 'STANDBY'}
                      </span>
                    </div>
                  </div>
                </div>

                <div>
                  <div className="text-xs text-cyan-400 mb-3">COORDINATES</div>
                  <div className="bg-black/50 p-3 rounded border border-gray-800 font-mono text-xs space-y-1">
                    {latentDims.map((val, i) => (
                      <div key={i} className="flex justify-between">
                        <span className="text-gray-500">z[{i}]</span>
                        <span className={Math.abs(val) > 0.7 ? 'text-pink-400' : 'text-cyan-400'}>
                          {val > 0 ? '+' : ''}{val.toFixed(4)}
                        </span>
                      </div>
                    ))}
                  </div>
                </div>

                <div className="pt-6 border-t border-gray-800">
                  <div className="text-xs text-gray-600 space-y-2">
                    <p>Navigate the latent space using the XY pad or dimensional sliders.</p>
                    <p className="text-cyan-400/50">Standalone version — No backend required</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div className="bg-gray-900 border-t border-cyan-500/30 px-4 py-2 flex justify-between items-center text-xs">
            <div className="text-gray-500">
              Exploring the sound between human memory and machine imagination
            </div>
            <div className="text-cyan-400/50">
              LATENT ORGAN © 2025
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<LatentOrganInterface />, document.getElementById('root'));
  </script>
</body>
</html>
